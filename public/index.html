<html>
    <head>
        <title>
            LifeTiles
        </title>
        <link type="text/css" rel="stylesheet" href="bootstrap/css/bootstrap.css"></style>
        <style type="text/css">
            body {
                margin:5px;
            }
            .tile {
                float:left;
                height:200px;
                background-color:#f11;
                margin:5px;
                position:relative;
                overflow:hidden;
            }
            .new {
                width:0px;
            }

            .texthover {
                z-index:1;
                position:absolute;
                display:none;
                background-color:#ccc;
                width:190px;
                padding:5px;
                height:30px;
                bottom:0px;
            }

        </style>
        <script src="holder/holder.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script type="text/javascript">
            var tiles = [];

            var highest_id = 0

            function getTiles() {
                $.get("/home/index/" + highest_id, function(r) {
                    r = JSON.parse(r)
                    for (i = 0; i < r.length; i++) {
                        tile = r[i];
                        if (tile["id"] > highest_id) {
                            highest_id = tile.id
                            t = {}
                            t["text"] = tile["description"]
                            t["src"] = tile["image"]
                            tiles.push(t)
                            console.log("added a tile")
                        }
                    }
                });
            }

            function hoverIn() {
                $(this.children).next(".texthover").attr("style", "display:block;");
            }

            function hoverOut() {
                $(this.children).next(".texthover").attr("style", "display:none;");
            }

            kfade = 500

            function addTile() {
                $(".new").attr("class", "tile");
                if (tiles.length > 0) {
                    tile = tiles.shift();
                    $("body").prepend('<div class="tile new"><img src="' + tile["src"] +'"></img><div class="texthover">' + tile["text"] + '</div></div>');
                    $(".new").animate({width:"200px"},kfade);
                    Holder.run();
                    $(".new").hover(hoverIn, hoverOut);
                }
            }
            $(document).ready(function() {

                addTile();
                setInterval(addTile, 2*kfade);
                setInterval(getTiles, 300);
            });
        </script>
    </head>
    <body>
    </body>
</html>
